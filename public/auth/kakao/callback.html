<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>로그인 처리 중...</title>
</head>
<body style="margin: 0; min-height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 13px; color: #666;">
  <p id="msg" style="margin: 0 24px 8px;">로그인 처리 중...</p>
  <p id="debug" style="margin: 0 24px; font-size: 11px; color: #999;"></p>
  <script>
    (function() {
      var params = new URLSearchParams(window.location.search);
      var code = params.get('code');
      var error = params.get('error');
      var errorDesc = params.get('error_description');
      var debugEl = document.getElementById('debug');

      if (error) {
        if (debugEl) debugEl.textContent = 'error 수신';
        window.location.href = 'sumtayo://kakao?error=' + encodeURIComponent(errorDesc || error);
        return;
      }
      if (!code) {
        if (debugEl) debugEl.textContent = 'code 없음 - 카카오 Redirect URI 확인';
        return;
      }
      if (debugEl) debugEl.textContent = 'code 수신됨 (길이 ' + code.length + ') → 앱으로 이동 시도';
      document.getElementById('msg').textContent = '앱으로 이동합니다...';

      window.location.href = 'sumtayo://kakao?code=' + encodeURIComponent(code);

      // 앱이 안 열리면(웹/데스크톱) 2.5초 후 우리 사이트 로그인으로
      setTimeout(function() {
        window.location.replace('https://sumtayo.co.kr/login?code=' + encodeURIComponent(code) + '&from=kakao');
      }, 2500);
    })();
  </script>
</body>
</html>
